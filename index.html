<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AlphaJournal — Entrar / Criar Conta</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="auth-wrap">
    <div class="auth-card">
      <h1 class="brand">AlphaJournal</h1>

      <div class="tabs">
        <button id="tabLogin" class="tab active">Entrar</button>
        <button id="tabRegister" class="tab">Criar Conta</button>
      </div>

      <form id="loginForm" class="form">
        <input name="email" type="email" placeholder="Email" required>
        <input name="password" type="password" placeholder="Senha" required>
        <button type="submit" class="btn primary">Entrar</button>
        <div id="loginMsg" class="msg"></div>
      </form>

      <form id="registerForm" class="form hidden">
        <input id="regEmail" type="email" placeholder="Email" required>
        <input id="regPassword" type="password" placeholder="Senha (min 6)" required>
        <button id="btnRegister" type="button" class="btn primary">Criar Conta</button>
        <div id="regMsg" class="msg"></div>
      </form>

      <div style="text-align:center; margin-top:10px;" class="muted">Versão • Alpha MVP</div>
    </div>
  </div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import {
  getAuth,
  signInWithEmailAndPassword,
  createUserWithEmailAndPassword,
  GoogleAuthProvider,
  signInWithPopup,
  onAuthStateChanged
} from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

// ---------- FIREBASE CONFIG (use seu config corrigido) ----------
const firebaseConfig = {
  apiKey: "AIzaSyBGeQ1-IKrCyC8hA2BETaJLidLpuYrCRmk",
  authDomain: "alphajournal-dc6bb.firebaseapp.com",
  projectId: "alphajournal-dc6bb",
  storageBucket: "alphajournal-dc6bb.appspot.com",
  messagingSenderId: "835722822229",
  appId: "1:835722822229:web:974ee6dc7b6696f1edcadc"
};
// -----------------------------------------------------------------

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const googleProvider = new GoogleAuthProvider();

// UI
const tabLogin = document.getElementById('tabLogin');
const tabRegister = document.getElementById('tabRegister');
const loginForm = document.getElementById('loginForm');
const registerForm = document.getElementById('registerForm');
const loginMsg = document.getElementById('loginMsg');
const regMsg = document.getElementById('regMsg');
const btnRegister = document.getElementById('btnRegister');

tabLogin.addEventListener('click', ()=>{ tabLogin.classList.add('active'); tabRegister.classList.remove('active'); loginForm.classList.remove('hidden'); registerForm.classList.add('hidden'); loginMsg.textContent=''; });
tabRegister.addEventListener('click', ()=>{ tabRegister.classList.add('active'); tabLogin.classList.remove('active'); registerForm.classList.remove('hidden'); loginForm.classList.add('hidden'); regMsg.textContent=''; });

// redirect if already logged
onAuthStateChanged(auth, (u) => { if(u) window.location.href = 'dashboard.html'; });

loginForm.addEventListener('submit', async (e) => {
  e.preventDefault();
  loginMsg.textContent = '';
  const email = loginForm.email.value.trim();
  const password = loginForm.password.value.trim();
  try {
    await signInWithEmailAndPassword(auth, email, password);
    window.location.href = 'dashboard.html';
  } catch (err) {
    loginMsg.textContent = err.message || err.code;
  }
});

btnRegister.addEventListener('click', async () => {
  regMsg.textContent = '';
  const email = document.getElementById('regEmail').value.trim();
  const password = document.getElementById('regPassword').value.trim();
  if (!email || !password) { regMsg.textContent = 'Preencha email e senha.'; return; }
  if (password.length < 6) { regMsg.textContent = 'Senha mínima 6 caracteres.'; return; }
  try {
    await createUserWithEmailAndPassword(auth, email, password);
    alert('Conta criada! Faça login.');
    tabLogin.click();
  } catch (err) {
    regMsg.textContent = err.message || err.code;
  }
});
</script>
</body>
</html>
